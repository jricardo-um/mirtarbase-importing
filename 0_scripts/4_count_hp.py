lista = {
 '1': {
  "Homo sapiens": [
   "BMI1", "WNT3A", "MYB", "CDC25A", "CCND2", "RAB9B", "ACTR1A", "TPI1", "PDCD4", "RAB21", "BCL2", "WT1", "ASXL2",
   "TMEM251", "CARD8", "CDC14B", "CENPJ", "CEP63", "CREBL2", "ECHDC1", "GOLGA5", "GOLPH3L", "GTF2H1", "H3F3B", "HACE1",
   "HDHD2", "HERC6", "RIDA", "HSDL2", "HSPA1A", "JUN", "MCL1", "MSH2", "OMA1", "OSGEPL1", "PDCD6IP", "PHKB", "PMS1",
   "PNN", "PRIM1", "RAD51C", "RHOT1", "RNASEL", "SLC35A1", "SLC35B3", "TIA1", "UGDH", "UGP2", "ZNF559", "CCND1",
   "CCNE1", "BACE1", "DMTF1", "BRCA1", "AKT3", "WIPF1", "VPS45", "HSP90B1", "SKAP2", "NT5DC1", "FAM69A", "C2orf74",
   "FAM122C", "PWWP2A", "C17orf80", "PRIMPOL", "LDAH", "HPF1", "NIPAL2", "TRMT13", "ANAPC16", "CADM1", "TMEM184B",
   "APP", "UCP2", "VEGFA", "TSPYL2", "NFKB1", "CHUK", "TP53", "FGF7", "CLCN3", "CRKL", "MN1", "HMGA1", "HMGA2", "IFNG",
   "PURA", "RECK", "DLK1"
  ]
 },
 '2': {
  "Homo sapiens": [
   "PLA2G2D", "ACVR1B", "IKBKG", "GCLM", "PCF11", "HIST1H2BK", "ODC1", "CALD1", "RPP30", "ASNSD1", "CCNYL1", "RGPD5",
   "PREB", "PDHX", "SNX6", "CNN3", "KIF1A", "NAB1", "CCT6B", "CHD4", "CLCC1", "GDI2", "BRWD1", "MAPK6", "PSMC4", "ATF2",
   "ATP6AP1", "FBXO3", "PRDX3", "CABIN1", "FASN", "SEC63", "PTAR1", "DSTYK", "FOXO1", "TMEM214", "TRIM28", "NOP2",
   "MYBL1", "TTC1", "BTRC", "REPIN1", "KLF4", "YAP1", "CARM1", "SOX5", "SHOC2", "PLEKHA1", "CEP55", "ZDHHC16", "STXBP3",
   "C1orf21", "AMOTL1", "BTG2", "ETNK1", "TARBP2", "MTFR1L", "USP15", "AKAP11", "FCF1", "ARIH1", "PAGR1", "SNTB2",
   "VPS4A", "C16orf72", "GOSR1", "MINK1", "RPS6KB1", "NAPG", "GALNT1", "PNPLA6", "ZCCHC3", "SOWAHC", "CCNT2", "UBR3",
   "ZNRF3", "YWHAH", "B3GNT2", "ACTR2", "CDV3", "U2SURP", "RARB", "ITPR1", "BHLHE40", "PI4K2B", "CANX", "PCMT1", "E2F3",
   "PPP1R11", "HSPA1B", "PIM1", "CD2AP", "CALU", "UBN2", "EN2", "MAFK", "FOXK1", "USP42", "ZFHX4", "RAD23B", "ZBTB34"
  ]
 },
 '3': {
  "Homo sapiens": [
   "SLC9A6", "ZNF275", "OGT", "LUZP1", "CHAC1", "SCAMP4", "PAK2", "ENTPD1", "UBE4A", "ARCN1", "PTPRJ", "TMEM138",
   "RASSF5", "MAPKAPK2", "BCL7A", "SKI", "RCOR1", "SPRED1", "SMAD3", "SCAMP5", "UBE2Q2", "DCTN5", "PSKH1", "ANKRD13B",
   "EZH1", "PNPO", "SNX11", "RNF138", "IER2", "TNFSF9", "ENTPD6", "KIF3B", "NOL4L", "RASSF2", "CDS2", "ATP5G3",
   "TNRC6B", "SELENOI", "PEX13", "TET3", "PRKCD", "CPEB2", "TADA2B", "GRAMD2B", "CREBRF", "CDKN1A", "IRF4", "KLHDC10",
   "UBE3C", "SUN1", "HMBOX1", "RNF38", "PSAT1", "ZBTB33", "PAFAH1B2", "RPRD2", "PNRC2", "CDADC1", "AGO4", "GPR180",
   "PPM1A", "SLC39A9", "FAM103A1", "RBBP6", "PAFAH1B1", "TAOK1", "SNRPB2", "HSPE1-MOB4", "MOB4", "BZW1", "NUP50",
   "FGF2", "HSPA4L", "RBPJ", "TBPL1", "FZD6", "BAG4", "ZNF449", "YIPF6", "DDX3Y", "MSL1", "ENTPD7", "PRRC2C", "WEE1",
   "ELK4", "GABARAPL1", "PDIK1L", "ATXN7L3B", "ZNF691", "DYNLL2", "SRPRB", "CDC42SE2", "WIPI2", "TBRG1", "CHEK1",
   "TMEM109", "C1orf226", "SIRT4", "SETD1B", "HOXC8", "RAB3IP", "PPP2R5C", "SLCO3A1", "MLLT6", "CBX2", "ZFP28",
   "CHMP4B", "GABPA", "STRADB", "MTMR3", "CRIM1", "SOCS5", "CTDSPL", "ITGA2", "PIK3R1", "PPIL1", "CAPZA2", "ZNRF2",
   "IFT74", "OCRL", "CHIC1", "KLF6", "PHLPP1", "RET", "SIDT2", "ASCC1", "DMRT2", "TLL1", "LUC7L3", "ALDH3B1", "EFTUD2",
   "CSNK1E", "TPM2", "ZNF460", "FGFR4", "DOCK11", "ACTR3B", "ZNF367", "UBE2V1", "UBE2Q1", "TSC22D2", "TOB2",
   "TMEM189-UBE2V1", "TMEM189", "TM4SF1", "TFAP2A", "STK38", "SSRP1", "SIK1", "SH3BP4", "SEC24A", "RNF168", "REL",
   "PISD", "PDE4D", "NR6A1"
  ]
 },
 '4': {
  "Homo sapiens": [
   "NFIC", "NAA25", "LAMC1", "RUBCN", "IVNS1ABP", "IPPK", "HOXA3", "HEYL", "HDGF", "GNB1", "GNAL", "FURIN", "EIF1AX",
   "DYRK3", "CPSF7", "CDK6", "CARD10", "AVL9", "AGO2", "ABL2", "ABHD2", "ABCC6", "PRKAR2A", "VSIR", "PHYHIP", "CASKIN1",
   "ZNRF1", "CD180", "KIAA0895", "ORC4", "ODF2L", "DNAJA1", "L2HGDH", "ZNF622", "ZMAT3", "USP53", "SYPL1", "SRPRA",
   "SREK1", "SMAD7", "PRICKLE2", "LRIG2", "KIF5B", "FAM122B", "E2F7", "DDX3X", "CDCA4", "CDC37L1", "ATG9A", "ASGR2",
   "ZNF620", "HAUS3", "YTHDC1", "TMEM245", "TMEM100", "SRSF1", "SNX16", "SESTD1", "RIMS3", "RCAN3", "PPIG", "PLRG1",
   "PLAG1", "PHKA1", "MYO5A", "KIF23", "HNRNPDL", "CDK1", "CCNE2", "CBX6", "AXIN2", "CASK", "DMPK", "ATAD5", "AKR1B10",
   "GPATCH8", "ARHGDIA", "CPEB3", "JARID2", "CAMSAP1", "ATG14", "TRIM35", "FLCN", "NNT", "SLC2A3", "SBNO1", "POM121C",
   "NUFIP2", "LAMP2", "EFNB2", "RPL14", "GNAT1", "HOXA10", "CBX4", "PHC3", "PDCD1", "BAZ2A", "ZNF585B", "ANAPC13",
   "PRSS21", "RALGAPB", "GSG1", "POLDIP3", "AP5Z1", "CLSPN", "UGT2B4", "MAP4K2", "CCDC83", "DECR1", "ZBTB10", "YWHAQ",
   "USP48", "SALL1", "RUNX1T1", "RTN4", "PNISR", "PHLPP2", "PAG1", "NUCKS1", "MKX", "MBD4", "LRRFIP2", "KPNA3", "KPNA1",
   "HIGD1A", "HCFC2", "GRB2", "FKBP1A", "FBXL20", "CRK", "CLIP4", "CDK17", "CACUL1", "C11orf24", "ASH1L", "AMOT",
   "SLC29A1", "OSCAR", "MTHFR", "FAM229B", "EPM2AIP1", "ZNF267", "SSU72", "DNAJC10", "ZNF704", "YRDC", "TPM3",
   "TMEM161B", "TM7SF3", "TAF13", "SZRD1", "RNF149", "RACGAP1", "RAB23", "PTPRD", "PRKAA1", "PRDM4", "PLPP3", "LURAP1L",
   "KANK1"
  ]
 },
 '5': {
  "Homo sapiens": [
   "HIST2H2BE", "GPR27", "EXT1", "CYP26B1", "CNKSR3", "CA8", "BTN3A3", "ARHGAP12", "OSBPL3", "KRT33B", "TUBB2A",
   "MSANTD4", "LANCL1", "HNRNPA2B1", "KIAA1456", "SLC25A12", "DLGAP3", "THRAP3", "SMDT1", "RAPH1", "CCNT1", "ZNF391",
   "CCDC80", "ZBTB16", "XKR7", "WNK3", "VAV2", "TGFBR3", "RASEF", "NCKAP1", "MAP3K7", "KLHL15", "GNG12", "FZD9",
   "CMTM4", "CCDC88C", "ARMC12", "AHNAK2", "ACVR2A", "TLK1", "UBE2H", "TTLL5", "RIF1", "SERBP1", "PHF19", "LSM11",
   "PLPBP", "CLEC2D", "PDIA6", "N4BP1", "TRAK1", "ADRA2B", "ANKMY1", "GPRC5A", "C3orf36", "BSPRY", "ANKRD36", "KLHL40",
   "NOTCH2", "EIF2B2", "CUL3", "DCAF17", "RS1", "GLP2R", "FLOT2", "HNRNPA1L2", "NEGR1", "MCFD2", "HNRNPA1", "SLC35E2B",
   "ARHGAP32", "RAB15", "ADORA3", "PPIP5K2", "SYNRG", "ZNF91", "ZBTB5", "VPS33B", "CHMP3", "VCL", "USP3", "USP31",
   "TUBB", "TRAM1", "TMEM69", "PIP4P1", "TMEM135", "TLE4", "TKTL1", "TIMM13", "TFB1M", "TCF3", "TBL1XR1", "TBCCD1",
   "TBC1D20", "TBC1D14", "TASP1", "SUPT16H", "STX17", "SRPK1", "SPTLC1", "SMURF1", "SLC9A1", "SLC7A5", "SLC25A29",
   "SLC25A22", "RPS6KA3", "RPS5", "RPL36", "RNPS1", "RNMT", "RNH1", "RFWD2", "REXO1", "RELT", "RAP2C", "RAB40B",
   "RAB11FIP2", "PSMB5", "PPP6C", "POU2AF1", "POLE4", "PGD", "PEX12", "PANK1", "TM9SF2", "OTUB1", "NR2C2", "NCOR2",
   "MTMR4", "MRPL40", "MLXIP", "MIB1", "MED11", "MCM3AP-AS1", "ETFRF1", "LRRC57", "LRPPRC", "LITAF", "KLC2", "TECPR2",
   "KATNAL1", "IRAK1BP1", "HYOU1", "GSK3B", "GGA3", "GANAB", "GABARAP", "FRYL", "MIGA1", "AMER1", "EDC3", "DSCR3",
   "DPP8", "DNAJC9", "DICER1", "CYLD", "CYB561A3"
  ]
 },
 '6': {
  "Homo sapiens": [
   "CUL2", "CSDE1", "CREG1", "CPNE1", "RHOV", "CDKN2AIPNL", "CDC27", "CBFA2T3", "C6orf106", "C2orf42", "LRIF1",
   "C15orf39", "BSG", "B4GALT1", "ATP13A3", "ASXL1", "AP3M1", "AFF4", "ACOX1", "CXCL10", "CDKN2B", "BDNF", "IL10RA",
   "TNFAIP1", "AP2B1", "AURKAIP1", "BCL2L12", "C16orf58", "CLU", "CLUH", "DENND6A", "DIAPH1", "FBXL18", "GATAD2A",
   "HSPA8", "KMT2D", "MAP2K3", "PLEKHB2", "POLR2E", "PPP6R3", "RPRD1B", "SEC61A1", "SNCG", "WDR13", "C21orf62", "CD274",
   "JPT2", "RFK", "TXNIP", "VOPP1", "ZNF284", "HRSP12", "CCDC111", "C2orf43", "C4orf27", "C1ORF21", "C16ORF72", "EPT1",
   "GRAMD3", "C1ORF226", "KIAA0226", "C10orf54", "SRPR", "PPAP2B", "PROSC", "TMEM55B", "LYRM5", "FAM73A", "GSDMB",
   "DRD1", "LINC01565", "ADGRL1"
  ],
  "Mus musculus": [ "Cask", "Dmpk", "Pdcd1", "Npepps" ],
  "Rattus norvegicus": [ "Ccnd1" ]
 }
}
import sys

n = sys.argv[ 1 ]
lista = lista[ n ]
# ENRICHMENT

from gprofiler import GProfiler

skeys = ( 'native', )

oids = {
 'Bos taurus': 'btaurus',
 'Caenorhabditis elegans': 'celegans',
 'Canis familiaris': 'clfamiliaris',
 'Capra hircus': 'chircus',
 'Cricetulus griseus': 'cgchok1gshd',
 'Danio rerio': 'drerio',
 'Drosophila melanogaster': 'dmelanogaster',
 'Gallus gallus': 'ggallus',
 'Homo sapiens': 'hsapiens',
 'Macaca nemestrina': 'mnemestrina',
 'Mus musculus': 'mmusculus',
 'Oryzias latipes': 'olatipes',
 'Ovis aries': 'oaries',
 'Rattus norvegicus': 'rnorvegicus',
 'Sus scrofa': 'sscrofa',
 'Taeniopygia guttata': 'tguttata',
 'Xenopus tropicalis': 'xtropicalis'
}


def enrichment( specie_mtb: str, genes: list ):
	print( 'Enriching', genes, end=' ' )  # debug
	gp = GProfiler( return_dataframe=False )
	specie = oids[ specie_mtb ]
	if not specie: return None
	res = gp.profile(
	 organism=specie,
	 query=genes,
	)
	for r in res:
		try:
			s = { key: r[ key ] for key in skeys }
			if 'HP:' in r[ 'native' ]: yield s
		except:
			None


gpt = dict()
tpg = dict()
for animal, genes in lista.items():
	m = len( genes )
	for i, gen in enumerate( genes ):
		print( 'Gen', i, 'de', m, end=' ' )
		y = list( enrichment( animal, gen ) )
		for elm in y:
			e = elm[ 'native' ]
			try:
				gpt[ e ] += 1
			except:
				gpt[ e ] = 1
		l = len( y )
		if l:
			try:
				tpg[ gen ] += l
			except:
				tpg[ gen ] = l
		print( '+', l, 't', len( gpt ), 'g', len( tpg ), end='     \n', flush=True )
print( gpt )
print( tpg )
